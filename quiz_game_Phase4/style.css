/* Evidence inspection action buttons bottom-right positioning */
.inspection-actions {
    position: absolute;
    bottom: 32px;
    right: 48px;
    display: flex;
    flex-direction: row;
    gap: 16px;
    z-index: 1002;
}
/* Robot Intercom Icon - floating in the middle of the image, Pulsing */
.robot-intercom-icon {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1003;
    width: 150px;
    height: 150px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.robot-icon-img {
    width: 200px;
    height: 200px;
    border-radius: 50%;
    box-shadow: 0 0 16px #ffe066, 0 0 8px #222;
    background: rgba(255,255,255,0.15);
    animation: robotPulse 1s infinite;
}
@keyframes robotPulse {
    0% { box-shadow: 0 0 16px #ffe066, 0 0 8px #222; transform: scale(1); }
    50% { box-shadow: 0 0 32px #ffe066, 0 0 16px #222; transform: scale(1.08); }
    100% { box-shadow: 0 0 16px #ffe066, 0 0 8px #222; transform: scale(1); }
}
/* Case Brief Screen Responsive Layout */


#locationSuccess {
    display: none;
    width: 100%;
    max-width: 100%;
    padding: 20px;
    box-sizing: border-box;
    overflow-y: auto;
    max-height: 85vh;
}

#locationSuccess.active {
    display: block;
}

.case-brief-screen *, #locationSuccess * {
    z-index: 10000 !important;
}

.case-brief-content {
    max-width: 90vw;
    max-height: 80vh;
    padding: 2vw 2vh;
    font-size: 1.5em;
    color: #ffe066;
    background: rgba(45,45,45,0.85);
    border-radius: 18px;
    box-shadow: 0 0 32px #222;
    overflow: auto;
    margin: 0 auto;
}

@media (max-width: 600px) {
    .case-brief-content {
        font-size: 1em;
        padding: 1vw 1vh;
        max-width: 98vw;
        max-height: 90vh;
    }
}
/* Smooth Fade-In Overlay */
#fadeOverlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: #000;
    z-index: 3000;
    opacity: 1;
    pointer-events: none;
    transition: opacity 1.2s cubic-bezier(0.4,0,0.2,1);
}
#fadeOverlay.fade-out {
    opacity: 0;
}
/* ===================================
   NAIROBI NOIR - CYBERPUNK STYLES
   Blade Runner meets Nairobi Back Alley
   =================================== */

:root {
    /* Lightened noir backgrounds - 30% brighter for visibility */
    --noir-black: #1a1a22;
    --noir-dark: #252530;
    --noir-gray: #32323f;
    --noir-light-gray: #4a4a58;
    
    /* Bright readable text */
    --noir-white: #f5f5f5;
    --neon-cream: #ffffff;
    --noir-cream: #ffffff;
    
    /* Primary neon accents - Nairobi nightlife */
    --neon-red: #ff2a4a;
    --noir-red: #ff2a4a;
    --neon-amber: #ffaa00;
    --noir-yellow: #ffaa00;
    --neon-cyan: #4a9ead;
    --noir-blue: #4a9ead;
    --noir-green: #4a9ead;
    --neon-pink: #ff1a6c;
    
    /* Muted earth tones - dusty Nairobi streets */
    --noir-sepia: #6a5a4a;
    
    /* Glow effects - neon reflections on wet streets */
    --glow-red: 0 0 15px rgba(255, 42, 74, 0.4), 0 0 30px rgba(255, 42, 74, 0.2);
    --glow-amber: 0 0 15px rgba(255, 170, 0, 0.4), 0 0 30px rgba(255, 170, 0, 0.2);
    --glow-yellow: 0 0 15px rgba(255, 170, 0, 0.4), 0 0 30px rgba(255, 170, 0, 0.2);
    --glow-cyan: 0 0 15px rgba(74, 158, 173, 0.4), 0 0 30px rgba(74, 158, 173, 0.2);
    --glow-blue: 0 0 15px rgba(74, 158, 173, 0.4), 0 0 30px rgba(74, 158, 173, 0.2);
    
    /* Film grain - gritty urban texture */
    --film-grain: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Special Elite', monospace;
    background: var(--noir-black);
    overflow-x: hidden;
    overflow-y: auto;
    cursor: crosshair;
    max-width: 100vw;
    /* Nairobi noir cyberpunk filter - desaturated with subtle color cast (30% brighter) */
    filter: contrast(1.15) saturate(0.7) brightness(1.24);
}

/* Film grain overlay - gritty Nairobi texture */
body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: var(--film-grain);
    opacity: 0.042;
    pointer-events: none;
    z-index: 2000;
    mix-blend-mode: overlay;
    /* grainShift animation removed to stop scrollbar dancing */
}

@keyframes grainShift {
    0%, 100% { transform: translate(0, 0); }
    25% { transform: translate(-1px, 1px); }
    50% { transform: translate(1px, -1px); }
    75% { transform: translate(-1px, -1px); }
}

/* Heavy vignette - Fincher darkness (30% lighter) */
body::after {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: radial-gradient(ellipse at center, transparent 20%, rgba(0,0,0,0.35) 60%, rgba(0,0,0,0.665) 100%);
    pointer-events: none;
    z-index: 1999;
}

/* Ambient neon lighting - distant city glow */
.neon-ambient {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 40%;
    background: 
        radial-gradient(ellipse 80% 50% at 20% 100%, rgba(255, 42, 74, 0.08) 0%, transparent 50%),
        radial-gradient(ellipse 60% 40% at 80% 100%, rgba(74, 158, 173, 0.06) 0%, transparent 50%),
        radial-gradient(ellipse 100% 30% at 50% 100%, rgba(255, 170, 0, 0.04) 0%, transparent 40%);
    pointer-events: none;
    z-index: 1;
    opacity: 0.9;
}

.game-container {
    position: relative;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    /* Nairobi night ambience - subtle color cast */
    background: linear-gradient(135deg, 
        rgba(5, 5, 10, 1) 0%, 
        rgba(10, 8, 15, 1) 50%, 
        rgba(5, 5, 8, 1) 100%
    );
}

/* Venetian blind shadow effect - harsh noir lighting (30% lighter) */
.game-container::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: repeating-linear-gradient(
        -5deg,
        transparent,
        transparent 40px,
        rgba(0, 0, 0, 0.175) 40px,
        rgba(0, 0, 0, 0.175) 44px
    );
    pointer-events: none;
    z-index: 1998;
    opacity: 0.42;
    animation: blindSway 8s ease-in-out infinite;
}

@keyframes blindSway {
    0%, 100% { transform: translateX(0); }
    50% { transform: translateX(5px); }
}

/* Nairobi rain effect - heavier, more dramatic */
@keyframes rain {
    0% { background-position: 0 0; }
    100% { background-position: 30px 800px; }
}

.game-container::after {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: 
        linear-gradient(180deg, transparent 0%, rgba(74, 158, 173, 0.02) 50%, transparent 100%),
        repeating-linear-gradient(
            90deg,
            transparent,
            transparent 2px,
            rgba(200, 200, 220, 0.015) 2px,
            rgba(200, 200, 220, 0.015) 3px
        );
    background-size: 100% 100%, 5px 100%;
    pointer-events: none;
    z-index: 1997;
    animation: rain 0.4s linear infinite;
}

/* ===================================
   CONTROL PANEL - Nairobi Cyberpunk Console
   =================================== */

.control-dropdown {
    position: fixed;
    top: 20px;
    left: 20px;
    z-index: 1001;
}

.control-toggle {
    background: linear-gradient(180deg, rgba(15, 15, 20, 0.95) 0%, rgba(8, 8, 12, 0.98) 100%);
    color: var(--neon-amber);
    border: 1px solid var(--neon-red);
    border-radius: 0;
    padding: 12px 24px;
    font-family: 'Special Elite', monospace;
    cursor: pointer;
    font-size: 13px;
    font-weight: bold;
    letter-spacing: 3px;
    text-transform: uppercase;
    transition: all 0.3s ease;
    box-shadow: var(--glow-red), inset 0 0 20px rgba(255, 42, 74, 0.1);
    position: relative;
    overflow: hidden;
}

.control-toggle::before {
    content: '▸';
    margin-right: 8px;
    color: var(--neon-red);
    text-shadow: 0 0 10px var(--neon-red);
}

.control-toggle:hover {
    background: linear-gradient(180deg, rgba(255, 42, 74, 0.15) 0%, rgba(15, 15, 20, 0.98) 100%);
    border-color: var(--neon-amber);
    color: var(--neon-amber);
    transform: none;
    box-shadow: var(--glow-amber), inset 0 0 30px rgba(255, 170, 0, 0.1);
}

.control-panel {
    display: none;
    flex-direction: column;
    background: linear-gradient(180deg, rgba(10, 10, 15, 0.98) 0%, rgba(5, 5, 8, 0.99) 100%);
    border: 1px solid var(--neon-cyan);
    border-top: none;
    padding: 15px;
    margin-top: 0;
    gap: 8px;
    box-shadow: var(--glow-cyan), inset 0 0 40px rgba(74, 158, 173, 0.05);
}

.control-panel.active {
    display: flex;
    animation: consoleFlicker 0.1s ease, dropdownSlide 0.3s ease;
}

@keyframes consoleFlicker {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.8; }
}

@keyframes dropdownSlide {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}


.control-btn:hover {
    background: linear-gradient(90deg, rgba(255, 170, 0, 0.2) 0%, transparent 100%);
    color: var(--neon-amber);
    border-left-color: var(--neon-amber);
    padding-left: 20px;
    text-shadow: 0 0 10px var(--neon-amber);
}

.control-btn:active {
    background: rgba(255, 170, 0, 0.3);
}

/* ===================================
   DETECTIVE'S TOOLBOX - Neon Interface
   =================================== */

.toolbox {
    position: fixed;
    right: 15px;
    bottom: 15px;
    left: auto;
    top: auto;
    transform: none;
    background: linear-gradient(180deg, rgba(10, 10, 15, 0.95) 0%, rgba(5, 5, 8, 0.98) 100%);
    border: 1px solid var(--neon-cyan);
    border-radius: 0;
    padding: 10px;
    z-index: 999;
    width: 60px;
    transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1);
    box-shadow: var(--glow-cyan), inset 0 0 20px rgba(74, 158, 173, 0.1);
    display: block;
}

.toolbox.active {
    display: block;
    animation: slideInLeft 0.5s ease;
}

@keyframes slideInLeft {
    from {
        transform: translateX(150px) translateY(0);
        opacity: 0;
    }
    to {
        transform: translateX(0) translateY(0);
        opacity: 1;
    }
}

.toolbox.expanded {
    /* responsive width so toolbox fits smaller viewports */
    width: min(280px, 75vw);
}

.toolbox-toggle {
    cursor: pointer;
    transition: transform 0.3s ease;
}

.toolbox-toggle:hover {
    transform: scale(1.05);
    filter: drop-shadow(0 0 15px var(--neon-amber));
}

.toolbox-icon-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    filter: drop-shadow(0 0 8px var(--neon-amber)) drop-shadow(0 0 4px var(--neon-red));
}

.toolbox-panel {
    display: none;
    margin-top: 12px;
    border-top: 1px solid var(--noir-yellow);
    padding-top: 12px;
    max-height: 60vh;
    overflow-y: auto;
}

.toolbox.expanded .toolbox-panel {
    display: block;
    animation: fadeIn 0.3s ease;
}

.toolbox-title {
    font-family: 'Bebas Neue', sans-serif;
    color: var(--noir-yellow);
    font-size: 16px;
    margin-bottom: 8px;
    text-align: center;
    letter-spacing: 2px;
}

.toolbox-item {
    margin: 8px 0;
    padding: 10px;
    border: 1px solid var(--noir-light-gray);
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.3s ease;
    background: rgba(42, 42, 42, 0.5);
    display: flex;
    align-items: center;
    gap: 10px;
}

.toolbox-item:hover {
    border-color: var(--noir-yellow);
    background: rgba(244, 208, 63, 0.1);
    box-shadow: 0 0 12px var(--glow-yellow);
    transform: translateX(3px);
}

.toolbox-item-img {
    width: 40px;
    height: 40px;
    object-fit: cover;
    border-radius: 4px;
    flex-shrink: 0;
}

.toolbox-item h4 {
    font-family: 'Special Elite', monospace;
    color: var(--noir-yellow);
    margin-bottom: 2px;
    font-size: 11px;
}

.toolbox-item p {
    font-size: 10px;
    color: var(--noir-white);
}

.puzzle-pieces-toolbox {
    display: flex;
    gap: 8px;
    margin-top: 10px;
    flex-wrap: wrap;
}

.toolbox-piece-thumb {
    width: 40px;
    height: 40px;
    border: 1px solid var(--noir-light-gray);
    border-radius: 4px;
    overflow: hidden;
    background: rgba(26,26,26,0.6);
    display: flex;
    align-items: center;
    justify-content: center;
}

.toolbox-piece-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.room-status {
    font-size: 12px;
    margin: 5px 0;
    color: var(--noir-white);
}

/* ===================================
   PHASE SCREENS
   =================================== */

.phase-screen {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: none;
    opacity: 0;
    transition: opacity 1s cubic-bezier(0.4, 0, 0.2, 1), transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    transform: scale(1.02);
    overflow-x: hidden;
    overflow-y: auto;
    max-width: 100vw;
    box-sizing: border-box;
}

.phase-screen.active {
    display: flex;
    opacity: 1;
    transform: scale(1);
    animation: phaseEnter 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes phaseEnter {
    from {
        opacity: 0;
        transform: scale(1.02);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

/* ===================================
   CHARACTER SELECTION
   =================================== */

.char-selection {
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: linear-gradient(180deg, #0a0a0a 0%, #1a1a1a 50%, #0a0a0a 100%) !important;
    z-index: 100;
}

.title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 80px;
    color: var(--noir-cream);
    text-align: center;
    margin-bottom: 20px;
    text-shadow: 
        2px 2px 0 #000,
        4px 4px 8px rgba(0,0,0,0.8),
        0 0 40px rgba(212, 165, 74, 0.3);
    letter-spacing: 12px;
    animation: flicker 4s infinite;
    /* Art deco styling */
    border-bottom: 2px solid var(--noir-yellow);
    padding-bottom: 10px;
}

@keyframes flicker {
    0%, 100% { opacity: 1; }
    92% { opacity: 1; }
    93% { opacity: 0.8; }
    94% { opacity: 1; }
    96% { opacity: 0.9; }
    97% { opacity: 1; }
}

@keyframes titleGlow {
    0%, 100% { text-shadow: 2px 2px 0 #000, 4px 4px 8px rgba(0,0,0,0.8), 0 0 30px rgba(212, 165, 74, 0.3); }
    50% { text-shadow: 2px 2px 0 #000, 4px 4px 8px rgba(0,0,0,0.8), 0 0 50px rgba(212, 165, 74, 0.5); }
}

.subtitle {
    font-family: 'Crimson Text', serif;
    font-size: 40px;
    font-style: italic;
    color: var(--noir-cream);
    margin-bottom: 60px;
    text-align: center;
    letter-spacing: 3px;
    text-transform: uppercase;
    animation: fadeIn 1s ease;
    /*small letters*/
    text-transform: lowercase;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.character-options {
    display: flex;
    gap: 60px;
    margin-bottom: 40px;
}

.character-card {
    width: 200px;
    height: 280px;
    background: linear-gradient(180deg, #1a1a1a 0%, #0a0a0a 100%);
    border: 2px solid var(--noir-sepia);
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.4s ease;
    box-shadow: 
        0 10px 30px rgba(0,0,0,0.8),
        inset 0 1px 0 rgba(255,255,255,0.05);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
    /* Film noir photo frame look */
    padding: 8px;
}

.character-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
    transition: left 0.5s ease;
}

.character-card:hover::before {
    left: 100%;
}

.character-card:hover {
    border-color: var(--noir-cream);
    box-shadow: 
        0 15px 40px rgba(0,0,0,0.9),
        0 0 20px rgba(212, 165, 74, 0.2);
    transform: translateY(-10px) scale(1.02);
}

.character-card.selected {
    border-color: var(--noir-cream);
    background: linear-gradient(180deg, #252525 0%, #1a1a1a 100%);
    box-shadow: 
        0 15px 40px rgba(0,0,0,0.9),
        0 0 30px rgba(212, 165, 74, 0.3);
}

.character-image {
    width: 120px;
    height: 120px;
    margin-bottom: 20px;
    transition: all 0.3s ease;
    filter: grayscale(100%);
}

.character-card:hover .character-image,
.character-card.selected .character-image {
    filter: grayscale(0%);
    transform: scale(1.1);
}

.character-label {
    font-family: 'Special Elite', monospace;
    font-size: 24px;
    color: var(--noir-white);
    text-transform: uppercase;
    letter-spacing: 2px;
    transition: color 0.3s ease;
}

.character-card:hover .character-label,
.character-card.selected .character-label {
    color: var(--noir-yellow);
}

.name-input-container {
    margin-top: 40px;
    opacity: 0;
    transition: opacity 0.5s ease;
    pointer-events: none;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.name-input-container.visible {
    opacity: 1;
    pointer-events: all;
    animation: slideUp 0.5s ease;
}

@keyframes slideUp {
    from {
        transform: translateY(30px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.name-input {
    background: linear-gradient(180deg, #1a1a1a 0%, #0f0f0f 100%);
    border: 1px solid var(--noir-sepia);
    border-bottom: 2px solid var(--noir-yellow);
    border-radius: 2px;
    color: var(--noir-cream);
    padding: 15px 30px;
    font-family: 'Special Elite', monospace;
    font-size: 18px;
    text-align: center;
    width: 400px;
    margin-bottom: 20px;
    transition: all 0.3s ease;
    letter-spacing: 3px;
    text-transform: uppercase;
}

.name-input:focus {
    outline: none;
    border-bottom-color: var(--noir-cream);
    box-shadow: 0 4px 20px rgba(0,0,0,0.5);
}

.name-input::placeholder {
    color: var(--noir-light-gray);
    letter-spacing: 2px;
    text-transform: none;
}

.btn-primary {
    background: linear-gradient(180deg, var(--noir-yellow) 0%, #b8923a 100%);
    border: none;
    border-radius: 2px;
    color: var(--noir-black);
    padding: 15px 50px;
    font-family: 'Special Elite', monospace;
    font-size: 16px;
    cursor: pointer;
    text-transform: uppercase;
    letter-spacing: 3px;
    transition: all 0.3s ease;
    box-shadow: 
        0 4px 15px rgba(0,0,0,0.5),
        inset 0 1px 0 rgba(255,255,255,0.3);
    margin: 0 auto;
    display: block;
    position: relative;
    overflow: hidden;
}

.btn-primary::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    transition: left 0.4s ease;
}

.btn-primary:hover::before {
    left: 100%;
}

.btn-primary:hover {
    box-shadow: 
        0 6px 20px rgba(0,0,0,0.6),
        0 0 30px rgba(212, 165, 74, 0.3);
    transform: translateY(-2px);
}

.btn-primary:active {
    transform: translateY(0);
    box-shadow: 0 2px 10px rgba(0,0,0,0.5);
}

.btn-primary:disabled {
    opacity: 0.4;
    cursor: not-allowed;
    box-shadow: none;
    background: var(--noir-light-gray);
}

/* ===================================
   RULES OVERLAY - Noir Case File Style
   =================================== */

.rules-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(5, 5, 5, 0.97);
    z-index: 2000;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 40px;
    animation: fadeIn 0.5s ease;
}

.rules-overlay.active {
    display: flex;
}

.rules-content {
    background: linear-gradient(180deg, #1a1a1a 0%, #0f0f0f 100%);
    border: 1px solid var(--noir-sepia);
    border-top: 4px solid var(--noir-yellow);
    border-radius: 3px;
    padding: 50px;
    max-width: 800px;
    max-height: 85vh;
    overflow-y: auto;
    box-shadow: 
        0 20px 60px rgba(0, 0, 0, 0.8),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
    animation: scaleIn 0.5s ease;
}

@keyframes scaleIn {
    from {
        transform: scale(0.8);
        opacity: 0;
    }
    to {
        transform: scale(1);
        opacity: 1;
    }
}

.rules-content h2 {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 48px;
    color: var(--noir-yellow);
    margin-bottom: 30px;
    text-align: center;
    letter-spacing: 4px;
    text-shadow: 0 0 20px var(--glow-yellow);
}

.rules-content h3 {
    font-family: 'Special Elite', monospace;
    font-size: 20px;
    color: var(--noir-yellow);
    margin-top: 25px;
    margin-bottom: 10px;
}

.rules-content p, .rules-content ul {
    font-size: 20px;
    line-height: 1.8;
    margin-bottom: 15px;
    color: var(--noir-white);
}

.rules-content ul {
    list-style: none;
    padding-left: 20px;
}

.rules-content li {
    margin-bottom: 10px;
    position: relative;
}

.rules-content li::before {
    content: '▸';
    position: absolute;
    left: -20px;
    color: var(--noir-yellow);
}

/* ===================================
   DIALOGUE BOX - Film Noir Style
   =================================== */

.dialogue-box {
    position: fixed; /* should be middle centered*/
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: linear-gradient(180deg, rgba(20, 20, 20, 0.98) 0%, rgba(10, 10, 10, 0.98) 100%);
    border: 1px solid var(--noir-sepia);
    border-bottom: 3px solid var(--noir-sepia);
    border-radius: 0px;
    padding: 25px 35px;
    max-width: 600px;
    width: 90%;
    max-height: 7vh; /*reduce height*/
    z-index: 3000;
    display: none;
    opacity: 0;
    pointer-events: none;
    box-shadow: 
        0 10px 40px rgba(0, 0, 0, 0.8),
        inset 0 1px 0 rgba(255, 255, 255, 0.05),
        0 0 60px rgba(0, 0, 0, 0.5);
    overflow-y: auto;
    transition: opacity 0.4s ease-in-out;
    /* Typewriter paper texture feel */
    background-image: 
        linear-gradient(180deg, rgba(20, 20, 20, 0.98) 0%, rgba(10, 10, 10, 0.98) 100%),
        repeating-linear-gradient(0deg, transparent, transparent 28px, rgba(255,255,255,0.02) 28px, rgba(255,255,255,0.02) 29px);
}

.dialogue-box.active {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: flex-start;
    opacity: 1;
    animation: dialogueFadeIn 0.5s ease-in-out;
}

@keyframes dialogueFadeIn {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
    }
}

.dialogue-detective-icon {
    width: 55px;
    height: 55px;
    border-radius: 50%;
    border: 2px solid var(--noir-sepia);
    margin-right: 20px;
    object-fit: cover;
    flex-shrink: 0;
    display: none;
    /* Vintage photo effect */
    filter: grayscale(40%) contrast(1.1);
    box-shadow: 0 3px 10px rgba(0,0,0,0.5);
}

.dialogue-box.character .dialogue-detective-icon {
    display: block;
    border-color: var(--noir-cream);
}

/* Intercom dialogue boxes */
.dialogue-box.intercom .dialogue-detective-icon {
    display: block;
    border-color: #00ff88;
    filter: none;
    box-shadow: 0 0 15px rgba(0, 255, 136, 0.4);
}

.dialogue-box.intercom {
    border-radius: 3px;
    border-left: 4px solid #00ff88;
    background: linear-gradient(180deg, rgba(10, 20, 15, 0.98) 0%, rgba(5, 15, 10, 0.98) 100%);
}

/* Character dialogue boxes */
.dialogue-box.character {
    border-radius: 3px;
    border-left: 4px solid var(--noir-yellow);
}

.dialogue-text {
    font-family: 'Special Elite', monospace;
    font-size: 15px;
    line-height: 1.8;
    color: var(--noir-cream);
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    flex: 1;
    letter-spacing: 0.5px;
}

.dialogue-text.typing::after {
    content: '|';
    animation: blink 0.8s infinite;
    margin-left: 2px;
    color: var(--noir-yellow);
}

@keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
}

/* ===================================
   TEXT MESSAGE CONTAINER
   =================================== */

.text-message-container {
    position: fixed;
    top: 50%;
    left: 0;
    right: 0;
    transform: translateY(-50%);
    width: 100%;
    z-index: 900;
    display: none;
    padding: 0 40px;
}

.text-message-container.active {
    display: block;
}

.text-messages {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.text-message {
    border-radius: 10px;
    max-width: 250px;
    animation: messageSlideIn 0.4s ease;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
}

@keyframes messageSlideIn {
    from {
        transform: translateY(20px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.text-message.driver {
    background: rgba(26, 26, 26, 0.95);
    border: 2px solid var(--noir-yellow);
    border-radius: 10px;
    color: var(--noir-white);
    padding: 8px 15px;
    font-family: 'Crimson Text', serif;
    font-size: 14px;
    width: 250px;
    margin-bottom: 12px;
    transition: all 0.3s ease;
    box-shadow: 0 0 15px rgba(209, 162, 41, 0.3);
    align-self: flex-start;
    margin-left: 0;
}

.text-message.player {
    background: rgba(26, 26, 26, 0.95);
    border: 2px solid var(--neon-cyan);
    border-radius: 10px;
    color: var(--neon-cyan);
    padding: 8px 15px;
    font-family: 'Crimson Text', serif;
    font-size: 14px;
    width: 250px;
    margin-bottom: 12px;
    transition: all 0.3s ease;
    box-shadow: 0 0 15px rgba(74, 158, 173, 0.3);
    align-self: flex-end;
    margin-right: 0;
}

.text-message.sender {
    font-family: 'Special Elite', monospace;
    font-size: 10px;
    color: var(--noir-yellow);
    margin-bottom: 4px;
    text-transform: uppercase;
}

.text-message.player .text-message.sender {
    color: var(--neon-cyan);
}

.text-message.content {
    font-family: 'Crimson Text', serif;
    font-size: 14px;
    color: var(--noir-white);
}

/* ===================================
   FLOATING TEXT
   =================================== */

.floating-text {
    position: absolute;
    background: rgba(26, 26, 26, 0.95);
    border: 2px solid var(--noir-yellow);
    border-radius: 10px;
    padding: 15px 25px;
    font-family: 'Crimson Text', serif;
    font-size: 18px;
    color: var(--noir-white);
    z-index: 800;
    box-shadow: 0 0 20px var(--glow-yellow);
    animation: floatIn 0.5s ease;
}

@keyframes floatIn {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.floating-text.speaker {
    color: var(--noir-yellow);
    font-weight: 600;
}

/* ===================================
   PHASE I - THE CALL
   =================================== */

.phase-call {
    flex-direction: column;
    background: var(--noir-black);
}

/* Floating texts should sit below dialogue box */
.floating-text { z-index: 2000 }

/* Evidence bag overlay */
.bag-overlay {
    position: fixed;
    inset: 0;
    display: none;
    align-items: center;
    justify-content: center;
    background: rgba(0,0,0,0.7);
    z-index: 3500;
}
.bag-overlay .bag-content {
    background: var(--noir-dark);
    border: 3px solid var(--noir-blue);
    padding: 18px;
    border-radius: 10px;
    width: min(640px, 92vw);
    color: var(--noir-white);
}
.bag-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    margin-top: 12px;
}
.bag-item {
    display: flex;
    gap: 10px;
    align-items: center;
    padding: 10px;
    border-radius: 8px;
    background: rgba(30,58,95,0.1);
    border: 2px solid transparent;
    cursor: pointer;
    transition: all 0.3s ease;
}
.bag-item:hover {
    border-color: var(--noir-yellow);
    background: rgba(244, 208, 63, 0.15);
    box-shadow: 0 0 15px var(--glow-yellow);
    transform: translateY(-2px);
}
.bag-item:active {
    transform: scale(0.98);
}
.bag-item img { width:48px; height:48px; object-fit:cover; border-radius:6px; transition: transform 0.3s ease; }
.bag-item:hover img { transform: scale(1.1); }
.close-bag { float:right; background:transparent; border:none; color:var(--noir-white); font-size:18px }

.video-container {
    width: 100%;
    height: 100%;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
}

.fullscreen-video,
.fullscreen-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* Brighten and enlarge envelope scene image */
#envelopeScene .fullscreen-image {
    filter: brightness(1.3);
    transform: scale(1.02);
}

.news-headlines {
    position: absolute;
    left: 40px;
    top: 50%;
    transform: translateY(-50%);
    max-width: 450px;
}

.headline {
    background: var(--noir-black);
    border-left: 3px solid var(--noir-red);
    border-radius: 0px;
    padding: 18px;
    margin-bottom: 18px;
    font-family: 'Special Elite', monospace;
    font-size: 14px;
    opacity: 0;
    box-shadow: 0 0 30px 4px rgba(220, 20, 60, 0.7);
    animation: slideInLeft 0.6s ease forwards;
}

.headline-title {
    font-weight: bold;
    font-size: 14px;
    margin-bottom: 5px;
    color: var(--noir-red);
}

.headline-desc {
    font-size: 11px;
    font-style: italic;
    opacity: 0.9;
    line-height: 1.4;
    color: #b0b0b0;
    margin-top: 5px;
}

.headline:nth-child(1) { animation-delay: 0s; }
.headline:nth-child(2) { animation-delay: 0.5s; }
.headline:nth-child(3) { animation-delay: 1s; }
.headline:nth-child(4) { animation-delay: 1.5s; }
.headline:nth-child(5) { animation-delay: 2s; }
.headline:nth-child(6) { animation-delay: 2.5s; }

@keyframes slideInLeft {
    from {
        transform: translateX(-100px);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

/* Clickable Elements */
.clickable-tv,
.clickable-door,
.clickable-envelope {
    position: absolute;
    cursor: pointer;
    transition: all 0.3s ease;
}

.clickable-tv {
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(244, 208, 63, 0.2);
    border: 3px dashed var(--noir-yellow);
    border-radius: 15px;
    padding: 30px 50px;
}

.clickable-tv p,
.clickable-door p,
.clickable-envelope p {
    font-family: 'Special Elite', monospace;
    color: var(--noir-yellow);
    font-size: 18px;
    text-transform: uppercase;
    letter-spacing: 2px;
}

.clickable-door {
    top: 40%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(244, 208, 63, 0);
    border: 3px dashed transparent;
    border-radius: 15px;
    padding: 30px 50px;
    cursor: pointer;
    pointer-events: none; /* Allow clicks to pass through to parent */
}

.clickable-door.show-hint {
    background: rgba(244, 208, 63, 0.2);
    border: 3px dashed var(--noir-yellow);
}

.clickable-envelope {
    bottom: 20%;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(244, 208, 63, 0);
    border: 3px dashed transparent;
    border-radius: 15px;
    padding: 30px 50px;
    cursor: pointer;
    pointer-events: none; /* Allow clicks to pass through to parent */
}

.clickable-envelope.show-hint {
    background: rgba(244, 208, 63, 0.2);
    border: 3px dashed var(--noir-yellow);
}

/* ===================================
   EVIDENCE TABLE
   =================================== */

.evidence-table-background {
    width: 100%;
    height: 100%;
    background-image: url('tabletop.png');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
}

.evidence-table {
    width: 100%;
    height: 100%;
    display: flex;
    position: relative;
}

.evidence-items-small {
    width: 50%;
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    grid-template-rows: repeat(2, 1fr);
    padding: 40px;
    gap: 30px;
    background: rgba(0, 0, 0, 0.4);
}

.evidence-detail {
    position: absolute;
    top: 0;
    right: 0;
    width: 50%;
    height: 100%;
    padding: 40px;
    background: transparent;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
}

.evidence-detail.active {
    opacity: 1;
    pointer-events: auto;
}

.evidence-item {
    background: rgba(42, 42, 42, 0.9);
    border: 3px solid var(--noir-light-gray);
    border-radius: 15px;
    padding: 25px;
    cursor: pointer;
    transition: all 0.4s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
    aspect-ratio: 1;
}

.evidence-item::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: radial-gradient(circle, rgba(244, 208, 63, 0.1) 0%, transparent 70%);
    opacity: 0;
    transition: opacity 0.4s ease;
}

.evidence-item:hover::before {
    opacity: 1;
}

.evidence-item:hover {
    border-color: var(--noir-yellow);
    box-shadow: 0 0 30px var(--glow-yellow);
    transform: scale(1.08);
}

.evidence-item.selected {
    border-color: var(--noir-yellow);
    background: var(--noir-black);
    box-shadow: 0 0 40px var(--glow-yellow);
}

.evidence-item.inspected {
    opacity: 0.7;
}

.evidence-item-img {
    width: 100%;
    max-height: 70%;
    object-fit: contain;
    margin-bottom: 15px;
    border-radius: 10px;
    transition: transform 0.3s ease;
}

.evidence-item:hover .evidence-item-img {
    transform: scale(1.05);
}

.evidence-label {
    font-family: 'Special Elite', monospace;
    font-size: 13px;
    text-align: center;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--noir-white);
    transition: color 0.3s ease;
}

.inspection-panel {
    width: 85%;
    max-width: 420px;
    max-height: 75vh;
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    animation: floatIn 0.5s ease;
    background: rgba(20, 20, 20, 0.95);
    border: none;
    border-radius: 15px;
    padding: 20px;
    overflow-y: auto;
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.8), 0 0 30px rgba(244, 208, 63, 0.2);
    color: var(--noir-white);
}

@keyframes floatIn {
    from {
        opacity: 0;
        transform: translateY(30px) scale(0.95);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

.inspection-panel.active {
    display: flex;
}

.inspection-image {
    max-width: 100%;
    max-height: 180px;
    border: 2px solid var(--noir-yellow);
    border-radius: 8px;
    margin-bottom: 15px;
    box-shadow: 0 0 20px var(--glow-yellow);
}

.inspection-text {
    font-family: 'Crimson Text', serif;
    font-size: 14px;
    line-height: 1.5;
    max-width: 400px;
    color: var(--noir-white);
}

.inspection-text h3 {
    font-family: 'Bebas Neue', sans-serif;
    color: var(--noir-yellow);
    font-size: 22px;
    margin-bottom: 10px;
    letter-spacing: 2px;
}

.inspection-text p {
    margin-bottom: 6px;
    color: var(--noir-white);
}

.inspection-text strong {
    color: var(--noir-yellow);
}

.clue-text {
    color: var(--noir-yellow);
    font-family: 'Special Elite', monospace;
    font-size: 11px;
    margin-top: 10px;
    padding: 8px;
    background: rgba(244, 208, 63, 0.1);
    border-left: 2px solid var(--noir-yellow);
    border-radius: 4px;
}

/* ===================================
   CHOICE BUTTONS
   =================================== */

.choice-container {
    position: absolute;
    bottom: 100px;
    left: 50%;
    transform: translateX(-50%);
    display: none;
    gap: 40px;
}

.choice-container.active {
    display: flex;
    animation: fadeInUp 0.5s ease;
}

@keyframes fadeInUp {
    from {
        transform: translateX(-50%) translateY(50px);
        opacity: 0;
    }
    to {
        transform: translateX(-50%) translateY(0);
        opacity: 1;
    }
}

.choice-btn {
    background: var(--noir-dark);
    border: 3px solid var(--noir-yellow);
    border-radius: 10px;
    color: var(--noir-white);
    padding: 20px 50px;
    font-family: 'Special Elite', monospace;
    font-size: 18px;
    cursor: pointer;
    text-transform: uppercase;
    letter-spacing: 2px;
    transition: all 0.3s ease;
    box-shadow: 0 0 20px var(--glow-yellow);
}

.choice-btn:hover {
    background: var(--noir-yellow);
    color: var(--noir-black);
    box-shadow: 0 0 40px var(--glow-yellow);
    transform: translateY(-5px);
}

.choice-btn:active {
    transform: translateY(-2px);
}

/* ===================================
   MEMORY ROOM
   =================================== */

.memory-room {
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: radial-gradient(circle, var(--noir-dark) 0%, var(--noir-black) 100%);
}

.memory-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 18px;
    margin: 30px 0;
    width: 95vw;
    max-width: 1000px;
    height: 85vh;
    max-height: 650px;
    padding: 20px;
    perspective: 2000px;
}

.memory-tile {
    width: 100%;
    height: 100%;
    background: transparent;
    border: 3px solid var(--noir-light-gray);
    border-radius: 14px;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    position: relative;
    transform-style: preserve-3d;
    perspective: 1000px;
    box-shadow: 0 0 15px rgba(244, 208, 63, 0.4), 0 8px 25px rgba(0, 0, 0, 0.5);
    animation: cardIdle 3s ease-in-out infinite;
    animation-delay: calc(var(--card-index, 0) * 0.1s);
}

@keyframes cardIdle {
    0%, 100% { transform: translateY(0) rotateX(0); }
    50% { transform: translateY(-3px) rotateX(2deg); }
}

.memory-tile:nth-child(odd) {
    animation-delay: 0.5s;
}

.memory-tile:nth-child(even) {
    animation-delay: 1s;
}

.memory-tile:hover {
    border-color: var(--noir-yellow);
    box-shadow: 0 0 45px var(--glow-yellow), 0 0 60px rgba(244, 208, 63, 0.4), inset 0 0 20px rgba(244, 208, 63, 0.3);
    transform: scale(1.12) translateY(-8px) rotateY(5deg);
    animation: none;
    z-index: 10;
}

.memory-tile:active {
    transform: scale(1.05) translateY(-2px);
    transition: transform 0.1s ease;
}

.tile-front, .tile-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--noir-gray);
    border-radius: 12px;
    transition: all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.tile-front {
    z-index: 2;
    transform: rotateY(0deg);
    overflow: hidden;
    background: linear-gradient(145deg, #3a3a3a 0%, #1a1a1a 100%);
    border: 2px solid rgba(244, 208, 63, 0.3);
}

.tile-back {
    background: linear-gradient(145deg, #1a1a1a 0%, #0a0a0a 100%);
    transform: rotateY(180deg);
    border: 3px solid var(--noir-yellow);
    box-shadow: inset 0 0 30px rgba(244, 208, 63, 0.5), 0 0 20px rgba(244, 208, 63, 0.3);
}

.memory-tile.flipped .tile-front {
    transform: rotateY(180deg);
}

.memory-tile.flipped .tile-back {
    transform: rotateY(0deg);
}

.memory-tile.flipped {
    animation: cardFlipBounce 0.6s ease;
}

@keyframes cardFlipBounce {
    0% { transform: scale(1); }
    30% { transform: scale(1.15) translateY(-10px); }
    60% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

.memory-tile.matched {
    opacity: 0.85;
    pointer-events: none;
    border-color: var(--noir-green);
    animation: matchedCelebrate 0.8s ease forwards;
}

.memory-tile.matched .tile-back {
    border-color: var(--noir-green);
    background: linear-gradient(145deg, #2d6a4f 0%, #1a4a35 100%);
}

@keyframes matchedCelebrate {
    0% { transform: scale(1) rotateZ(0); }
    25% { transform: scale(1.2) rotateZ(-5deg); }
    50% { transform: scale(1.15) rotateZ(5deg); box-shadow: 0 0 50px rgba(45, 106, 79, 1); }
    75% { transform: scale(1.1) rotateZ(-2deg); }
    100% { transform: scale(1) rotateZ(0); opacity: 0.85; }
}

/* Shuffle animation styles */
.memory-tile.shuffling {
    animation: shuffleDance 0.5s ease-in-out;
    pointer-events: none;
}

@keyframes shuffleDance {
    0% { transform: translateX(0) translateY(0) rotateZ(0) scale(1); }
    25% { transform: translateX(-30px) translateY(-20px) rotateZ(-15deg) scale(0.9); }
    50% { transform: translateX(30px) translateY(20px) rotateZ(15deg) scale(0.85); }
    75% { transform: translateX(-20px) translateY(-10px) rotateZ(-10deg) scale(0.9); }
    100% { transform: translateX(0) translateY(0) rotateZ(0) scale(1); }
}

.memory-tile.shuffle-scatter {
    animation: shuffleScatter 0.6s ease-in-out;
    pointer-events: none;
}

@keyframes shuffleScatter {
    0% { transform: translate(0, 0) rotate(0deg) scale(1); opacity: 1; }
    30% { transform: translate(var(--scatter-x, 50px), var(--scatter-y, 50px)) rotate(var(--scatter-rot, 180deg)) scale(0.7); opacity: 0.7; }
    60% { transform: translate(calc(var(--scatter-x, 50px) * -0.5), calc(var(--scatter-y, 50px) * -0.5)) rotate(calc(var(--scatter-rot, 180deg) * -0.5)) scale(0.85); opacity: 0.85; }
    100% { transform: translate(0, 0) rotate(0deg) scale(1); opacity: 1; }
}

.memory-grid.shuffle-active {
    animation: gridPulse 0.8s ease-in-out;
}

@keyframes gridPulse {
    0%, 100% { box-shadow: none; }
    50% { box-shadow: 0 0 60px rgba(244, 208, 63, 0.6), 0 0 100px rgba(220, 20, 60, 0.4); }
}

.tile-image {
    width: 90%;
    height: 90%;
    object-fit: contain;
    transition: transform 0.3s ease;
}

.tile-image:hover {
    transform: scale(1.05);
}

.tile-complete-image {
    width: 840px;
    height: 560px;
    object-fit: none;
    position: absolute;
    left: 0;
    top: 0;
}

.memory-info {
    margin-top: 20px;
    font-family: 'Special Elite', monospace;
    font-size: 16px;
    color: var(--noir-yellow);
    display: flex;
    gap: 30px;
    justify-content: center;
}

.memory-controls {
    margin-top: 20px;
    text-align: center;
}

.memory-restart-btn {
    padding: 12px 30px;
    font-size: 14px;
}

/* Congratulations Overlay */
.congratulations-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(10, 10, 10, 0.95);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 1000;
}

.congratulations-overlay.active {
    display: flex;
    animation: fadeIn 0.5s ease;
}

.congrats-content {
    background: var(--noir-dark);
    border: 4px solid var(--noir-yellow);
    border-radius: 20px;
    padding: 50px;
    text-align: center;
    max-width: 600px;
    box-shadow: 0 0 60px var(--glow-yellow);
    animation: scaleIn 0.5s ease;
}

.congrats-content h2 {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 48px;
    color: var(--noir-yellow);
    margin-bottom: 20px;
    letter-spacing: 4px;
    text-shadow: 0 0 30px var(--glow-yellow);
}

.congrats-message {
    font-family: 'Crimson Text', serif;
    font-size: 24px;
    margin-bottom: 30px;
    color: var(--noir-white);
}

.final-stats {
    margin: 30px 0;
    padding: 20px;
    background: rgba(42, 42, 42, 0.5);
    border-radius: 10px;
}

.final-stats p {
    font-family: 'Special Elite', monospace;
    font-size: 20px;
    margin: 10px 0;
    color: var(--noir-white);
}

.final-stats strong {
    color: var(--noir-yellow);
}

.final-stats span {
    color: var(--noir-yellow);
    font-weight: bold;
}

.congrats-continue {
    font-family: 'Crimson Text', serif;
    font-size: 18px;
    font-style: italic;
    color: var(--noir-white);
    margin-top: 20px;
    animation: blink 1.5s ease-in-out infinite;
}

.timer-display {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 56px;
    color: var(--noir-yellow);
    margin-bottom: 30px;
    text-shadow: 0 0 20px var(--glow-yellow);
    animation: timerGlow 2s ease-in-out infinite;
}

@keyframes timerGlow {
    0%, 100% { text-shadow: 0 0 20px var(--glow-yellow); }
    50% { text-shadow: 0 0 35px var(--glow-yellow); }
}

.timer-display.warning {
    color: var(--noir-red);
    text-shadow: 0 0 30px var(--glow-red);
    animation: timerWarning 1s infinite;
}

@keyframes timerWarning {
    0%, 100% { 
        transform: scale(1);
        text-shadow: 0 0 30px var(--glow-red);
    }
    50% { 
        transform: scale(1.15);
        text-shadow: 0 0 50px var(--glow-red);
    }
}

/* ===================================
   PHASE 1: FILM NOIR QUIZ STYLING
   Calm, polished, intentional design
   =================================== */

.quiz-room {
    align-items: center;
    justify-content: center;
    padding: 20px;
    background: linear-gradient(180deg, var(--noir-black) 0%, var(--noir-dark) 100%);
}

/* Card-style Quiz Container */
.quiz-container {
    width: 100%;
    max-width: 700px;
    background: rgba(50, 50, 65, 0.95);
    border: 2px solid var(--neon-cyan);
    border-radius: 8px;
    padding: 40px;
    box-shadow: 0 0 30px rgba(74, 158, 173, 0.2);
    max-height: 90vh;
    overflow-y: auto;
}

/* Custom Scrollbar for Quiz Container */
.quiz-container::-webkit-scrollbar {
    width: 12px;
}

.quiz-container::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.3);
    border-radius: 0 8px 8px 0;
}

.quiz-container::-webkit-scrollbar-thumb {
    background: var(--neon-cyan);
    border-radius: 6px;
    border: 2px solid rgba(0, 0, 0, 0.3);
}

.quiz-container::-webkit-scrollbar-thumb:hover {
    background: var(--neon-amber);
    box-shadow: 0 0 10px rgba(255, 170, 0, 0.4);
}

/* Firefox scrollbar */
.quiz-container {
    scrollbar-width: thin;
    scrollbar-color: var(--neon-cyan) rgba(0, 0, 0, 0.3);
}

/* Header/Title */
.quiz-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 38px;
    color: var(--neon-amber);
    text-align: center;
    margin-bottom: 10px;
    letter-spacing: 4px;
    text-shadow: 0 0 20px rgba(255, 170, 0, 0.4);
}

.quiz-subtitle {
    text-align: center;
    color: rgba(255, 255, 255, 0.6);
    font-size: 16px;
    margin-bottom: 30px;
    font-style: italic;
}

/* Question Block */
.quiz-question-block {
    margin-bottom: 40px;
    padding-bottom: 30px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.quiz-question-block:last-of-type {
    border-bottom: none;
    margin-bottom: 30px;
}

.quiz-question-number {
    color: var(--neon-cyan);
    font-size: 12px;
    letter-spacing: 2px;
    margin-bottom: 10px;
    text-transform: uppercase;
}

/* Question Area */
.quiz-question {
    font-size: 18px;
    line-height: 1.7;
    margin-bottom: 30px;
    padding: 25px;
    background: rgba(0, 0, 0, 0.3);
    border-left: 4px solid var(--neon-cyan);
    border-radius: 0 8px 8px 0;
    color: var(--noir-white);
}

/* Answer Choices */
.quiz-answers {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-bottom: 30px;
}

.quiz-answer {
    display: flex;
    align-items: center;
    gap: 15px;
    background: rgba(60, 60, 80, 0.8);
    border: 2px solid rgba(255, 255, 255, 0.15);
    border-radius: 6px;
    padding: 16px 20px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 15px;
    line-height: 1.5;
}

.quiz-answer:hover {
    border-color: var(--neon-amber);
    background: rgba(255, 170, 0, 0.1);
    transform: translateX(5px);
}

.quiz-answer input[type="radio"] {
    appearance: none;
    width: 20px;
    height: 20px;
    border: 2px solid var(--neon-cyan);
    border-radius: 50%;
    cursor: pointer;
    flex-shrink: 0;
    transition: all 0.2s ease;
}

.quiz-answer input[type="radio"]:checked {
    background: var(--neon-amber);
    border-color: var(--neon-amber);
    box-shadow: 0 0 10px rgba(255, 170, 0, 0.5);
}

.quiz-answer:has(input:checked) {
    border-color: var(--neon-amber);
    background: rgba(255, 170, 0, 0.15);
}

.quiz-answer span {
    flex: 1;
}

/* Next Button */
.quiz-next-btn {
    display: block;
    width: 100%;
    background: var(--neon-cyan);
    color: var(--noir-black);
    border: none;
    border-radius: 6px;
    padding: 16px 30px;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 20px;
    letter-spacing: 3px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-bottom: 20px;
}

.quiz-next-btn:hover {
    background: var(--neon-amber);
    box-shadow: 0 0 20px rgba(255, 170, 0, 0.4);
    transform: translateY(-2px);
}

/* Progress Indicator */
.quiz-progress-container {
    margin-bottom: 30px;
}

.quiz-progress-bar {
    width: 100%;
    height: 8px;
    background: rgba(0, 0, 0, 0.4);
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 10px;
}

.quiz-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--neon-cyan), var(--neon-amber));
    border-radius: 4px;
    transition: width 0.4s ease;
    width: 20%;
    box-shadow: 0 0 10px rgba(74, 158, 173, 0.5);
}

.quiz-progress-text {
    text-align: center;
    color: rgba(255, 255, 255, 0.6);
    font-size: 14px;
    letter-spacing: 2px;
    text-transform: uppercase;
}

/* Selected Answer State */
.quiz-answer.selected {
    border-color: var(--neon-amber);
    background: rgba(255, 170, 0, 0.2);
    box-shadow: 0 0 15px rgba(255, 170, 0, 0.3);
}

.quiz-answer.selected .answer-radio {
    background: var(--neon-amber);
    border-color: var(--neon-amber);
    box-shadow: 0 0 10px rgba(255, 170, 0, 0.5);
}

/* Custom Radio Button */
.answer-radio {
    width: 20px;
    height: 20px;
    border: 2px solid var(--neon-cyan);
    border-radius: 50%;
    flex-shrink: 0;
    transition: all 0.2s ease;
}

/* Button States */
.quiz-next-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
}

.quiz-next-btn:disabled:hover {
    background: var(--neon-cyan);
    box-shadow: none;
    transform: none;
}

/* ===================================
   PHASE 3: FEEDBACK & RESULTS STYLES
   =================================== */

/* Answer Feedback States */
.quiz-answer.correct {
    border-color: #22c55e;
    background: rgba(34, 197, 94, 0.2);
    box-shadow: 0 0 15px rgba(34, 197, 94, 0.3);
    pointer-events: none;
}

.quiz-answer.correct .answer-radio {
    background: #22c55e;
    border-color: #22c55e;
    box-shadow: 0 0 10px rgba(34, 197, 94, 0.5);
}

.quiz-answer.incorrect {
    border-color: #ef4444;
    background: rgba(239, 68, 68, 0.2);
    box-shadow: 0 0 15px rgba(239, 68, 68, 0.3);
    pointer-events: none;
}

.quiz-answer.incorrect .answer-radio {
    background: #ef4444;
    border-color: #ef4444;
    box-shadow: 0 0 10px rgba(239, 68, 68, 0.5);
}

/* Disable hover on answered questions */
.quiz-answer.correct:hover,
.quiz-answer.incorrect:hover {
    transform: none;
}

/* Feedback Icons */
.feedback-icon {
    margin-left: auto;
    font-size: 18px;
}

/* ===================================
   RESULTS SCREEN STYLES
   =================================== */

.quiz-results {
    text-align: center;
}

.results-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 36px;
    color: var(--neon-amber);
    margin-bottom: 30px;
    letter-spacing: 3px;
    text-shadow: 0 0 20px rgba(255, 170, 0, 0.4);
}

.score-display {
    background: rgba(0, 0, 0, 0.4);
    border: 2px solid var(--neon-cyan);
    border-radius: 12px;
    padding: 30px;
    margin-bottom: 25px;
    display: inline-block;
    min-width: 200px;
}

.score-number {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 64px;
    color: var(--neon-amber);
    line-height: 1;
    text-shadow: 0 0 30px rgba(255, 170, 0, 0.5);
}

.score-label {
    font-size: 14px;
    color: rgba(255, 255, 255, 0.6);
    text-transform: uppercase;
    letter-spacing: 3px;
    margin-top: 10px;
}

.performance-message {
    font-size: 18px;
    line-height: 1.6;
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 30px;
    font-style: italic;
}

.performance-message.passed {
    background: rgba(34, 197, 94, 0.15);
    border: 1px solid rgba(34, 197, 94, 0.4);
    color: #86efac;
}

.performance-message.failed {
    background: rgba(239, 68, 68, 0.15);
    border: 1px solid rgba(239, 68, 68, 0.4);
    color: #fca5a5;
}

/* Results Buttons Container */
.results-buttons {
    display: flex;
    gap: 15px;
    margin-bottom: 20px;
}

.quiz-btn {
    flex: 1;
    border: none;
    border-radius: 6px;
    padding: 16px 30px;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 20px;
    letter-spacing: 3px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.redo-btn {
    background: rgba(60, 60, 80, 0.9);
    color: var(--noir-white);
    border: 2px solid var(--neon-cyan);
}

.redo-btn:hover {
    background: var(--neon-cyan);
    color: var(--noir-black);
    box-shadow: 0 0 20px rgba(74, 158, 173, 0.4);
    transform: translateY(-2px);
}

.forward-btn {
    background: var(--neon-amber);
    color: var(--noir-black);
}

.forward-btn:hover {
    background: #ffcc44;
    box-shadow: 0 0 20px rgba(255, 170, 0, 0.5);
    transform: translateY(-2px);
}

/* Next Challenge Screen */
.next-challenge {
    text-align: center;
    padding: 20px 0;
}

.loading-indicator {
    margin-top: 30px;
    font-size: 48px;
    animation: pulse 1.5s ease-in-out infinite;
}

@keyframes pulse {
    0%, 100% {
        opacity: 1;
        transform: scale(1);
    }
    50% {
        opacity: 0.6;
        transform: scale(1.1);
    }
}

/* Results Summary */
.results-summary {
    text-align: left;
    margin-top: 30px;
}

.summary-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 22px;
    color: var(--neon-cyan);
    margin-bottom: 20px;
    letter-spacing: 2px;
    text-transform: uppercase;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    padding-bottom: 10px;
}

.result-item {
    background: rgba(0, 0, 0, 0.3);
    border-radius: 8px;
    padding: 15px 20px;
    margin-bottom: 15px;
    border-left: 4px solid;
}

.result-item.result-correct {
    border-left-color: #22c55e;
}

.result-item.result-incorrect {
    border-left-color: #ef4444;
}

.result-question-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
}

.result-icon {
    font-size: 18px;
}

.result-question-num {
    font-size: 14px;
    color: var(--neon-cyan);
    text-transform: uppercase;
    letter-spacing: 1px;
    font-weight: bold;
}

.result-answers {
    font-size: 14px;
    line-height: 1.6;
}

.result-your-answer {
    color: rgba(255, 255, 255, 0.8);
    margin-bottom: 8px;
}

.result-your-answer.wrong {
    color: #fca5a5;
}

.result-correct-answer {
    color: #86efac;
}

/* ===================================
   ESCAPE ROOM
   =================================== */

 
.escape-room {
    background: var(--noir-black);
    position: fixed;
    width: 100vw;        /* full width */
    height: 100vh;       /* height should fit the screen*/
    overflow: hidden;
    top: 0;
    left: 0;

}

.escape-room .timer-display {
    position: absolute;
    top: 20px;
    right: 30px;
    left: auto;
    z-index: 50;
}

.room-view {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.escape-room .room-view {
    width: 100%;
    height: 100%;
}

.room-zone {
    position: absolute;
    cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><circle cx="12" cy="12" r="9" fill="none" stroke="%23F4D03F" stroke-width="2"/><line x1="20" y1="20" x2="28" y2="28" stroke="%23F4D03F" stroke-width="2"/></svg>') 12 12, pointer;
    transition: all 0.3s ease;
    border: 2px dashed transparent;
    border-radius: 10px;
    font-size: 0;
    opacity: 0;
    pointer-events: none;
}

/* Active zone - visible and clickable */
.room-zone.active-zone {
    opacity: 1;
    pointer-events: auto;
    border-color: var(--noir-yellow);
    background: rgba(244, 208, 63, 0.25);
    box-shadow: 0 0 30px var(--glow-yellow);
    animation: zoneGlow 1.5s ease-in-out infinite;
}

@keyframes zoneGlow {
    0%, 100% { box-shadow: 0 0 30px var(--glow-yellow); }
    50% { box-shadow: 0 0 50px var(--glow-yellow), 0 0 70px rgba(244, 208, 63, 0.3); }
}

.room-zone.active-zone .zone-hint {
    opacity: 1;
}

.room-zone::before,
.room-zone::after {
    display: none;
}

.room-zone:hover {
    border-color: var(--noir-yellow);
    background: rgba(244, 208, 63, 0.15);
    box-shadow: 0 0 25px var(--glow-yellow);
}

.zone-hint {
    position: absolute;
    bottom: -30px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(26, 26, 26, 0.95);
    color: var(--noir-yellow);
    padding: 8px 15px;
    border-radius: 5px;
    font-family: 'Special Elite', monospace;
    font-size: 12px;
    white-space: nowrap;
    opacity: 0;
    transition: opacity 0.3s ease;
    pointer-events: none;
}

.room-zone:hover .zone-hint {
    opacity: 1;
}

.zone-detail-panel {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(10, 10, 10, 0.98);
    display: none;
    align-items: center;
    justify-content: center;
    gap: 40px;
    padding: 30px;
    z-index: 100;
    overflow: hidden;
}

.zone-detail-panel.active {
    display: flex;
    animation: fadeIn 0.4s ease;
}

.close-zone {
    position: absolute;
    top: 30px;
    right: 30px;
    background: var(--noir-yellow);
    color: var(--noir-black);
    border: none;
    border-radius: 8px;
    padding: 12px 25px;
    font-family: 'Special Elite', monospace;
    cursor: pointer;
    font-size: 16px;
    transition: all 0.3s ease;
}

.close-zone:hover {
    box-shadow: 0 0 20px var(--glow-yellow);
    transform: scale(1.05);
}

.zone-image {
    width: 350px;
    height: 280px;
    object-fit: contain;
    border: 3px solid var(--noir-yellow);
    border-radius: 10px;
    box-shadow: 0 0 30px var(--glow-yellow);
    flex-shrink: 0;
}

.zone-description {
    max-width: 380px;
    max-height: 70vh;
    background: var(--noir-black);
    border: 3px solid #00BFFF;
    border-radius: 0px;
    padding: 20px;
    box-shadow: 0 0 40px 6px rgba(0, 191, 255, 0.7), inset 0 0 20px rgba(0, 191, 255, 0.3);
    overflow-y: auto;
}

.zone-description h3 {
    font-family: 'Bebas Neue', sans-serif;
    color: #00BFFF;
    font-size: 28px;
    margin-bottom: 15px;
    letter-spacing: 2px;
}

.zone-description p {
    font-family: 'Crimson Text', serif;
    font-size: 16px;
    line-height: 1.5;
    margin-bottom: 12px;
    color: var(--noir-white);
}

.zone-action-btn {
    background: var(--noir-yellow);
    border: none;
    border-radius: 8px;
    color: var(--noir-black);
    padding: 15px 35px;
    font-family: 'Special Elite', monospace;
    font-size: 16px;
    cursor: pointer;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-top: 20px;
    transition: all 0.3s ease;
}

.zone-action-btn:hover {
    box-shadow: 0 0 25px var(--glow-yellow);
    transform: scale(1.05);
}

.zone-action-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.clue-btn {
    background: transparent;
    border: 2px solid var(--noir-yellow);
    border-radius: 8px;
    color: var(--noir-yellow);
    padding: 10px 20px;
    font-family: 'Special Elite', monospace;
    font-size: 14px;
    cursor: pointer;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-top: 10px;
    transition: all 0.3s ease;
}

.clue-btn:hover {
    background: var(--noir-yellow);
    color: var(--noir-black);
    box-shadow: 0 0 15px var(--glow-yellow);
}

/* Detective question styling */
.detective-question {
    color: var(--noir-yellow);
    font-size: 18px;
    font-weight: bold;
    font-style: italic;
    margin-bottom: 15px;
}

/* Puzzle piece notice */
.puzzle-piece-notice {
    background: rgba(0, 191, 255, 0.2);
    border: 2px solid #00BFFF;
    border-radius: 8px;
    padding: 10px 15px;
    color: #00BFFF;
    font-size: 16px;
    margin: 10px 0;
    animation: puzzlePulse 1s ease-in-out infinite;
}

@keyframes puzzlePulse {
    0%, 100% { box-shadow: 0 0 10px rgba(0, 191, 255, 0.5); }
    50% { box-shadow: 0 0 25px rgba(0, 191, 255, 0.8); }
}

/* Riddle text styling */
.riddle-text {
    color: var(--noir-yellow);
    font-size: 16px;
    font-style: italic;
    margin: 15px 0;
    padding: 10px;
    background: rgba(244, 208, 63, 0.1);
    border-left: 3px solid var(--noir-yellow);
}

/* Code choice buttons */
.code-choice-container {
    display: flex;
    gap: 20px;
    margin: 15px 0;
}

.code-choice-btn {
    background: var(--noir-dark);
    border: 2px solid var(--noir-yellow);
    border-radius: 8px;
    color: var(--noir-yellow);
    padding: 15px 30px;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 28px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.code-choice-btn:hover {
    background: var(--noir-yellow);
    color: var(--noir-black);
    box-shadow: 0 0 20px var(--glow-yellow);
    transform: scale(1.05);
}

/* Toolbox tool item styling */
.toolbox-tool {
    border: 2px solid var(--noir-yellow);
    cursor: pointer;
    transition: all 0.3s ease;
}

.toolbox-tool:hover {
    background: rgba(244, 208, 63, 0.2);
    box-shadow: 0 0 15px var(--glow-yellow);
}

.code-input {
    background: var(--noir-dark);
    border: 2px solid var(--noir-yellow);
    border-radius: 8px;
    color: var(--noir-white);
    padding: 12px 20px;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 24px;
    text-align: center;
    width: 150px;
    margin-top: 15px;
    display: block;
}

.code-input:focus {
    outline: none;
    box-shadow: 0 0 20px var(--glow-yellow);
}

/* ===================================
   REVEAL SCREEN
   =================================== */

.reveal-screen {
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    background: radial-gradient(circle, var(--noir-dark) 0%, var(--noir-black) 100%);
    padding: 20px 0;
    overflow-y: auto;
}

.reveal-content {
    text-align: center;
    max-width: 100%;
    padding: 0 15px;
    box-sizing: border-box;
}

.puzzle-assembly h2 {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 48px;
    color: var(--noir-yellow);
    margin-bottom: 10px;
    letter-spacing: 4px;
    text-shadow: 0 0 30px var(--glow-yellow);
    animation: fadeIn 1s ease;
}

.puzzle-instructions {
    color: var(--noir-white);
    font-size: 14px;
    margin-bottom: 30px;
    font-style: italic;
    line-height: 1.5;
}

.puzzle-layout {
    display: flex;
    gap: clamp(20px, 4vw, 60px);
    justify-content: center;
    align-items: center;
    flex-wrap: nowrap;
    width: 100%;
    max-width: 100%;
    padding: 20px;
    box-sizing: border-box;
    margin-top: 10px;
    flex-direction: row;
    min-height: 70vh;
}

/* Two-grid layout: left for target board, right for scrambled source */
.puzzle-section {
    display: flex;
    flex-direction: column;
    gap: 10px;
    flex: 1 1 45%;
    max-width: 45%;
    transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}

.puzzle-section h3 {
    color: var(--noir-yellow);
    font-family: 'Special Elite', monospace;
    font-size: 16px;
    text-shadow: 0 0 15px var(--glow-yellow);
    text-align: center;
    transition: opacity 0.5s ease;
}

/* Fullscreen expansion when puzzle is complete */
.puzzle-section.puzzle-fullscreen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    max-width: 100vw;
    z-index: 200;
    background: rgba(0, 0, 0, 0.95);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

.puzzle-section.puzzle-fullscreen h3 {
    display: none;
}

.puzzle-section.puzzle-fullscreen .puzzle-board {
    width: 90vmin;
    height: 90vmin;
    max-width: 90vmin;
    min-height: auto;
    box-shadow: 0 0 100px rgba(45, 106, 79, 0.9), 0 0 200px rgba(244, 208, 63, 0.4);
}

.puzzle-layout.puzzle-layout-complete {
    justify-content: center;
}

.puzzle-source {
    flex: 0 0 auto;
    order: 2; /* Source on right */
    transition: opacity 0.5s ease, transform 0.5s ease;
}

.puzzle-source[style*="display: none"] {
    opacity: 0;
    transform: scale(0.8);
}

.puzzle-target {
    flex: 0 0 auto;
    order: 1; /* Target on left */
}

/* Puzzle Complete Info - shown on right after puzzle is solved */
.puzzle-complete-info {
    order: 2;
    display: flex;
    align-items: center;
    justify-content: center;
    animation: fadeInSlide 0.8s ease-out forwards;
}

@keyframes fadeInSlide {
    0% {
        opacity: 0;
        transform: translateX(30px);
    }
    100% {
        opacity: 1;
        transform: translateX(0);
    }
}

.puzzle-complete-message {
    background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(42, 42, 42, 0.9) 100%);
    border: 3px solid var(--noir-yellow);
    border-radius: 16px;
    padding: 40px;
    text-align: center;
    box-shadow: 0 0 40px var(--glow-yellow), inset 0 0 30px rgba(244, 208, 63, 0.1);
    max-width: 400px;
}

.puzzle-complete-message h3 {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 36px;
    color: var(--noir-yellow);
    letter-spacing: 4px;
    margin-bottom: 30px;
    text-shadow: 0 0 20px var(--glow-yellow);
}

.puzzle-complete-message .complete-text {
    font-family: 'Crimson Text', serif;
    font-size: 22px;
    color: var(--noir-white);
    line-height: 1.6;
    margin: 15px 0;
}

.puzzle-complete-message .complete-text.highlight {
    color: var(--noir-yellow);
    font-weight: 600;
    font-size: 24px;
    text-shadow: 0 0 10px rgba(244, 208, 63, 0.5);
}

.puzzle-complete-message .next-step-arrow {
    font-size: 32px;
    color: var(--noir-yellow);
    margin-top: 30px;
    animation: bounceArrow 1.5s ease-in-out infinite;
}

@keyframes bounceArrow {
    0%, 100% { transform: translateY(0); opacity: 0.6; }
    50% { transform: translateY(10px); opacity: 1; }
}

/* Source/scrambled pieces grid (3 rows x 4 cols for 12 pieces) */
.puzzle-pieces-container {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: repeat(3, 1fr);
    gap: 8px;
    padding: 12px;
    background: rgba(26, 26, 26, 0.6);
    border: 2px solid var(--noir-light-gray);
    border-radius: 12px;
    justify-content: center;
    aspect-ratio: 4 / 3;
    width: 100%;
    max-width: 45vw;
    height: auto;
    min-height: 30vw;
}

/* Target assembly board grid (4 cols x 3 rows for 12 slots) */
.puzzle-board {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: repeat(3, 1fr);
    gap: 2px; /* Minimal gap so pieces connect visually */
    padding: 4px;
    background: rgba(26, 26, 26, 0.8);
    border: 4px solid var(--noir-yellow);
    border-radius: 14px;
    box-shadow: 0 0 50px var(--glow-yellow), 0 0 80px rgba(244, 208, 63, 0.3);
    aspect-ratio: 4 / 3; /* Match the 4x3 grid ratio */
    width: 100%;
    max-width: 45vw;
    height: auto;
    min-height: 30vw;
    transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}

/* When puzzle is complete - remove gaps to form one continuous image */
.puzzle-board.puzzle-complete {
    gap: 0;
    padding: 0;
    border-radius: 8px;
    overflow: hidden;
    border: 4px solid var(--noir-green);
    box-shadow: 0 0 60px rgba(45, 106, 79, 0.8), 0 0 100px rgba(45, 106, 79, 0.4);
}

.puzzle-board.puzzle-complete .puzzle-slot {
    border: none;
    border-radius: 0;
    background: transparent;
    aspect-ratio: auto;
    overflow: hidden;
}

.puzzle-board.puzzle-complete .puzzle-slot .piece-image {
    border-radius: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.puzzle-slot {
    width: 100%;
    height: 100%;
    border: 2px dashed var(--noir-light-gray);
    border-radius: 8px;
    background: rgba(42, 42, 42, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    overflow: hidden;
    position: relative;
}

.puzzle-slot:hover {
    border-color: var(--noir-yellow);
    background: rgba(42, 42, 42, 0.8);
    box-shadow: inset 0 0 30px rgba(244, 208, 63, 0.3), 0 0 20px rgba(244, 208, 63, 0.3);
    transform: scale(1.05);
    animation: none;
}

.puzzle-slot.filled {
    border-color: var(--noir-green);
    border-style: solid;
    background: rgba(45, 106, 79, 0.3);
    animation: slotFilled 0.6s ease forwards;
}

@keyframes slotFilled {
    0% { transform: scale(1); }
    40% { transform: scale(1.15) rotate(3deg); box-shadow: 0 0 40px rgba(45, 106, 79, 0.8); }
    70% { transform: scale(1.08) rotate(-2deg); }
    100% { transform: scale(1) rotate(0deg); }
}

.puzzle-piece {
    width: 100%;
    height: 100%;
    aspect-ratio: 1;
    background: var(--noir-gray);
    border: 2px solid var(--noir-light-gray);
    border-radius: 8px;
    cursor: grab;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
    animation: pieceFloat 2.5s ease-in-out infinite;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
}

@keyframes pieceFloat {
    0%, 100% { transform: translateY(0) rotate(0deg); }
    50% { transform: translateY(-5px) rotate(1deg); }
}

.puzzle-piece:nth-child(odd) {
    animation-delay: 0.3s;
}

.puzzle-piece:nth-child(3n) {
    animation-delay: 0.6s;
}

.puzzle-piece.draggable {
    user-select: none;
}

.puzzle-piece:hover {
    border-color: var(--noir-yellow);
    box-shadow: 0 0 30px var(--glow-yellow), 0 15px 35px rgba(0, 0, 0, 0.5);
    transform: scale(1.15) translateY(-10px) rotate(2deg);
    animation: none;
    z-index: 10;
}

.puzzle-piece:active {
    transform: scale(1.1) translateY(-5px);
    cursor: grabbing;
}

.puzzle-piece.dragging {
    opacity: 0.6;
    cursor: grabbing;
}

.puzzle-piece.placed {
    opacity: 0.4;
    border-color: var(--noir-green);
    cursor: default;
}

.piece-image {
    width: 100%;
    height: 100%;
    background-size: 400% 300%;
    background-repeat: no-repeat;
    border-radius: 6px;
}

.puzzle-slot .piece-image {
    width: 100%;
    height: 100%;
    background-size: 400% 300%;
    background-repeat: no-repeat;
    display: block;
}

/* Ensure piece image fills entire slot when puzzle is complete */
.puzzle-board.puzzle-complete .puzzle-slot .piece-image {
    width: 100%;
    height: 100%;
    border-radius: 0;
    display: block;
}

@keyframes pieceAppear {
    0% {
        transform: scale(0) rotate(-180deg);
        opacity: 0;
    }
    50% {
        transform: scale(1.2) rotate(10deg);
    }
    100% {
        transform: scale(1) rotate(0);
        opacity: 1;
    }
}

.location-reveal {
    animation: fadeInScale 1s ease;
    text-align: center;
    padding: 20px;
    max-height: 100vh;
    overflow-y: auto;
    box-sizing: border-box;
}

.location-reveal h2 {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(32px, 6vw, 56px);
    color: var(--noir-yellow);
    margin-bottom: 15px;
    letter-spacing: 3px;
    text-shadow: 0 0 40px var(--glow-yellow);
}

.location-question {
    font-family: 'Special Elite', monospace;
    font-size: clamp(14px, 2vw, 18px);
    color: var(--noir-white);
    margin-bottom: 20px;
    font-style: italic;
    padding: 0 10px;
}

.location-choices {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: clamp(10px, 2vw, 25px);
    max-width: min(900px, 95vw);
    margin: 0 auto 20px;
    padding: clamp(10px, 2vw, 20px);
}

.location-choice {
    background: rgba(26, 26, 26, 0.9);
    border: 2px solid var(--noir-light-gray);
    border-radius: 12px;
    padding: clamp(8px, 1.5vw, 15px);
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    position: relative;
    overflow: hidden;
    animation: choiceFloat 3s ease-in-out infinite;
}

.location-choice:nth-child(1) { animation-delay: 0s; }
.location-choice:nth-child(2) { animation-delay: 0.5s; }
.location-choice:nth-child(3) { animation-delay: 1s; }
.location-choice:nth-child(4) { animation-delay: 1.5s; }

@keyframes choiceFloat {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-5px); }
}

.location-choice:hover {
    border-color: var(--noir-yellow);
    transform: scale(1.05) translateY(-8px);
    box-shadow: 0 0 40px var(--glow-yellow), 0 15px 40px rgba(0, 0, 0, 0.5);
    animation: none;
    z-index: 10;
}

.location-choice:active {
    transform: scale(1.02) translateY(-4px);
}

.location-choice.selected-wrong {
    border-color: var(--noir-red);
    box-shadow: 0 0 40px var(--glow-red);
    animation: wrongShake 0.5s ease;
}

@keyframes wrongShake {
    0%, 100% { transform: translateX(0); }
    20% { transform: translateX(-15px) rotate(-2deg); }
    40% { transform: translateX(15px) rotate(2deg); }
    60% { transform: translateX(-10px) rotate(-1deg); }
    80% { transform: translateX(10px) rotate(1deg); }
}

.location-choice.selected-correct {
    border-color: var(--noir-green);
    box-shadow: 0 0 60px rgba(45, 106, 79, 0.8);
    animation: correctPulse 0.8s ease;
}

@keyframes correctPulse {
    0% { transform: scale(1); }
    30% { transform: scale(1.1); box-shadow: 0 0 80px rgba(45, 106, 79, 1); }
    60% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

.choice-image {
    width: 100%;
    height: clamp(100px, 20vh, 180px);
    object-fit: cover;
    border-radius: 10px;
    margin-bottom: 8px;
    transition: all 0.3s ease;
    filter: grayscale(0.3);
}

.location-choice:hover .choice-image {
    filter: grayscale(0);
    transform: scale(1.02);
}

.choice-label {
    font-family: 'Special Elite', monospace;
    font-size: 16px;
    color: var(--noir-white);
    display: block;
    text-align: center;
}

.location-hint {
    font-family: 'Crimson Text', serif;
    font-size: 16px;
    color: var(--noir-yellow);
    font-style: italic;
    opacity: 0.8;
    max-width: 600px;
    margin: 20px auto;
    line-height: 1.6;
}

.location-hint.wrong-hint {
    color: var(--noir-red);
    animation: fadeIn 0.5s ease;
}

.location-success {
    animation: successReveal 1s ease;
    max-height: 85vh;
    overflow-y: auto;
}

.location-success h3 {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 42px;
    color: var(--noir-green);
    margin-bottom: 25px;
    letter-spacing: 4px;
    text-shadow: 0 0 30px rgba(45, 106, 79, 0.8);
}

/* Case Brief Styling */
.case-brief {
    background: rgba(10, 10, 10, 0.95);
    border: 3px solid var(--noir-yellow);
    border-radius: 15px;
    padding: 30px;
    margin-top: 20px;
    box-shadow: 0 0 40px var(--glow-yellow);
}

.case-brief-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 32px;
    color: var(--noir-yellow);
    text-align: center;
    margin-bottom: 25px;
    letter-spacing: 3px;
    text-shadow: 0 0 20px var(--glow-yellow);
}

.case-brief-content {
    display: flex;
    gap: 30px;
    flex-wrap: wrap;
    justify-content: center;
}

.case-images {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
    justify-content: center;
}

.case-image-item {
    text-align: center;
}

.case-photo {
    width: 180px;
    height: 140px;
    object-fit: cover;
    border: 3px solid var(--noir-yellow);
    border-radius: 10px;
    box-shadow: 0 0 20px var(--glow-yellow);
    transition: transform 0.3s ease;
}

.case-photo:hover {
    transform: scale(1.05);
}

.case-photo.map-photo {
    width: 280px;
    height: 200px;
}

.case-image-label {
    display: block;
    font-family: 'Special Elite', monospace;
    font-size: 12px;
    color: var(--noir-yellow);
    margin-top: 8px;
}

.case-details {
    flex: 1;
    min-width: 300px;
}

.case-detail-row {
    display: flex;
    margin-bottom: 12px;
    padding: 8px 0;
    border-bottom: 1px solid rgba(244, 208, 63, 0.2);
}

.case-label {
    font-family: 'Bebas Neue', sans-serif;
    color: #00BFFF;
    font-size: 16px;
    width: 160px;
    flex-shrink: 0;
    letter-spacing: 1px;
}

.case-value {
    font-family: 'Crimson Text', serif;
    color: var(--noir-white);
    font-size: 16px;
    flex: 1;
}

.case-value.highlight {
    color: var(--noir-yellow);
    font-weight: bold;
}

.case-evidence-section {
    margin-top: 20px;
    padding-top: 15px;
    border-top: 2px solid var(--noir-yellow);
}

.case-evidence-section h4 {
    font-family: 'Bebas Neue', sans-serif;
    color: var(--noir-yellow);
    font-size: 20px;
    margin-bottom: 15px;
    letter-spacing: 2px;
}

.case-evidence-list {
    list-style: none;
    padding: 0;
}

.case-evidence-list li {
    font-family: 'Crimson Text', serif;
    color: var(--noir-white);
    font-size: 14px;
    padding: 6px 0;
    padding-left: 20px;
    position: relative;
}

.case-evidence-list li::before {
    content: '✓';
    position: absolute;
    left: 0;
    color: var(--noir-green);
}

.case-status {
    text-align: center;
    margin-top: 25px;
    font-family: 'Special Elite', monospace;
    font-size: 18px;
    color: var(--noir-white);
}

.status-active {
    color: var(--noir-green);
    font-weight: bold;
    animation: statusPulse 1.5s ease-in-out infinite;
}

@keyframes statusPulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

@keyframes successReveal {
    0% { opacity: 0; transform: scale(0.8); }
    50% { transform: scale(1.05); }
    100% { opacity: 1; transform: scale(1); }
}

/* pulseGlow animation removed */

.location-image {
    max-width: 800px;
    width: 90%;
    border: 4px solid var(--noir-yellow);
    border-radius: 15px;
    box-shadow: 0 0 50px var(--glow-yellow), 0 0 100px rgba(244, 208, 63, 0.3);
    margin-bottom: 30px;
    animation: imageReveal 1.5s ease;
}

@keyframes imageReveal {
    0% { opacity: 0; transform: scale(0.8); filter: blur(20px); }
    50% { opacity: 0.7; filter: blur(5px); }
    100% { opacity: 1; transform: scale(1); filter: blur(0); }
}

.location-address {
    font-family: 'Special Elite', monospace;
    font-size: 24px;
    color: var(--noir-yellow);
    line-height: 1.8;
    animation: fadeIn 1s ease 0.5s both;
}

/* Empty Room Scene */
#emptyRoomScene {
    background: #000;
}

#emptyRoomScene .fullscreen-image {
    animation: emptyRoomReveal 3s ease;
    filter: sepia(0.3) contrast(1.1);
}

@keyframes emptyRoomReveal {
    0% { opacity: 0; transform: scale(1.1); }
    30% { opacity: 0.5; }
    100% { opacity: 1; transform: scale(1); }
}

/* Add vignette effect to empty room */
#emptyRoomScene::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(ellipse at center, transparent 40%, rgba(0, 0, 0, 0.7) 100%);
    pointer-events: none;
    animation: vignetteIntensify 5s ease forwards;
}

@keyframes vignetteIntensify {
    0% { background: radial-gradient(ellipse at center, transparent 60%, rgba(0, 0, 0, 0.3) 100%); }
    100% { background: radial-gradient(ellipse at center, transparent 30%, rgba(0, 0, 0, 0.8) 100%); }
}

.reveal-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 130px;
    color: var(--noir-yellow);
    text-align: center;
    text-shadow: 0 0 60px var(--glow-yellow);
    letter-spacing: 15px;
    animation: fadeInScale 2s ease;
}

.reveal-subtitle {
    font-family: 'Crimson Text', serif;
    font-size: 36px;
    font-style: italic;
    color: var(--noir-white);
    margin-top: 40px;
    animation: fadeIn 2s ease 1s both;
}

/* ===================================
   LOADING SCREEN
   =================================== */

.loading-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: var(--noir-black);
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    transition: opacity 0.5s ease;
}

.loading-spinner {
    width: 70px;
    height: 70px;
    border: 4px solid var(--noir-gray);
    border-top-color: var(--noir-yellow);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    box-shadow: 0 0 30px var(--glow-yellow);
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* ===================================
   NEWS ANCHOR BOX & LIVE INDICATOR
   =================================== */

.news-anchor-box {
    position: absolute;
    top: 30px;
    right: 40px;
    background: var(--noir-black);
    border: 3px solid var(--noir-red);
    border-radius: 0px;
    padding: 15px;
    display: flex;
    align-items: center;
    gap: 15px;
    box-shadow: 0 0 50px 8px rgba(220, 20, 60, 0.7), 0 0 30px rgba(220, 20, 60, 0.5);
    z-index: 100;
}

.news-anchor-image {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    border: 2px solid var(--noir-red);
    object-fit: cover;
    animation: newsAnchorThrob 2s ease-in-out infinite;
}

@keyframes newsAnchorThrob {
    0%, 100% {
        transform: scale(1);
        box-shadow: 0 0 0 rgba(220, 20, 60, 0.7);
    }
    50% {
        transform: scale(1.05);
        box-shadow: 0 0 20px rgba(220, 20, 60, 0.9);
    }
}

.live-indicator {
    display: flex;
    align-items: center;
    gap: 8px;
}

.live-dot {
    width: 12px;
    height: 12px;
    background: var(--noir-red);
    border-radius: 50%;
    box-shadow: 0 0 8px rgba(196, 30, 58, 0.7);
}

.live-text {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 20px;
    color: var(--noir-red);
    letter-spacing: 2px;
    font-weight: bold;
}

/* ===================================
   RESPONSIVE DESIGN
   =================================== */

@media (max-width: 1024px) {
    .title {
        font-size: 60px;
    }

    .evidence-left {
        padding: 40px;
    }

    .evidence-right {
        padding: 40px;
    }

    .zone-detail-panel {
        flex-direction: column;
        padding: 40px;
    }

    .zone-image {
        margin-right: 0;
        margin-bottom: 30px;
    }
}

@media (max-width: 768px) {
    .title {
        font-size: 48px;
    }

    .character-options {
        flex-direction: column;
        gap: 30px;
    }

    .memory-grid {
        grid-template-columns: repeat(4, 1fr);
        gap: 12px;
        width: 95vw;
        height: 80vh;
        max-width: none;
        max-height: none;
        padding: 12px;
    }

    .memory-tile {
        width: 100%;
        height: 100%;
        animation: cardIdle 4s ease-in-out infinite;
    }
    
    .puzzle-layout {
        flex-direction: column;
        gap: 15px;
        min-height: auto;
    }
    
    .puzzle-section {
        max-width: 100%;
    }
    
    .puzzle-pieces-container {
        grid-template-columns: repeat(4, minmax(50px, 18vw));
        grid-template-rows: repeat(3, minmax(50px, 18vw));
        gap: 6px;
    }
    
    .puzzle-board {
        grid-template-columns: repeat(4, minmax(50px, 18vw));
        grid-template-rows: repeat(3, minmax(50px, 18vw));
        gap: 6px;
    }
    
    .puzzle-slot,
    .puzzle-piece {
        width: 100%;
        height: 100%;
    }

    .rules-content {
        padding: 30px;
    }

    .evidence-table {
        flex-direction: column;
    }

    .evidence-items-small {
        width: 100%;
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: repeat(2, 1fr);
        padding: 20px;
        gap: 15px;
    }

    .evidence-detail {
        width: 100%;
        height: auto;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 100;
    }

    .evidence-left {
        grid-template-columns: 1fr;
    }

    .news-headlines {
        max-width: 90%;
        left: 5%;
    }
    
    .puzzle-layout {
        flex-direction: column;
    }
    
    .puzzle-source,
    .puzzle-target {
        order: unset;
    }
    
    /* Location choices mobile */
    .location-choices {
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
        padding: 8px;
    }
    
    .location-choice {
        padding: 8px;
        border-radius: 10px;
    }
    
    .choice-image {
        height: 80px;
        margin-bottom: 6px;
    }
    
    .choice-label {
        font-size: 12px;
    }
    
    .location-reveal h2 {
        font-size: 28px;
        margin-bottom: 10px;
    }
    
    .location-question {
        font-size: 14px;
        margin-bottom: 15px;
    }
    
    .location-hint {
        font-size: 13px;
        padding: 0 10px;
    }
    
    .location-success h3 {
        font-size: 28px;
    }
    
    .location-image {
        max-width: 95%;
    }
    
    .location-address {
        font-size: 16px;
    }
}

/* ===================================
   SCROLLBAR STYLING
   =================================== */

::-webkit-scrollbar {
    width: 8px;
}

::-webkit-scrollbar-track {
    background: var(--noir-dark);
}

::-webkit-scrollbar-thumb {
    background: var(--noir-gray);
    border-radius: 5px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--noir-light-gray);
}